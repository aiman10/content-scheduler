<div class="container">
  <div class="level my-4">
    <div class="level-left">
      <button (click)="onDateChangePrevious()" class="button">
        <i class="fas fa-arrow-left"></i>
      </button>
    </div>
    <div class="level-item">
      <h1 class="title is-size-3">{{ date }}</h1>
    </div>
    <div class="level-right">
      <button (click)="onDateChangeNext()" class="button">
        <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>

  <h2 class="title is-size-4">Bookmarked Movies</h2>

  <div *ngIf="isLoadingBookmarked" class="has-text-centered">
    <button class="button is-large is-loading is-white">
      Loading Bookmarked Movies...
    </button>
  </div>

  <div class="columns is-multiline">
    <div class="column is-one-third" *ngFor="let movie of bookmarkedMovies">
      <div class="card movie-card">
        <div class="card-image">
          <figure class="image is-2by3">
            <img
              [src]="'https://image.tmdb.org/t/p/original' + movie.poster_path"
              alt="{{ movie.title }}"
            />
          </figure>
        </div>
        <div class="card-content">
          <p class="title is-5">
            <a href="https://www.themoviedb.org/movie/{{ movie.id }}" target="_blank"
              >{{ movie.title }}</a
            >
          </p>
          <p class="subtitle is-6">
            <span *ngIf="!editing[movie.id]" (click)="enableEditing(movie)">
              {{ movie.release_date }} |
              <strong>{{ calculateReleasedYearsAgo(movie) }} year(s) ago</strong>
            </span>
            <input
              *ngIf="editing[movie.id]"
              type="text"
              [value]="movie.release_date"
              (keyup.enter)="updateReleaseDate($event, movie)"
              (blur)="disableEditing(movie)"
            />
          </p>
          <div class="buttons">
            <button (click)="downloadICSCalendar(movie)" class="button is-small">
              Download Calendar
            </button>
            <button
              class="transparent-button"
              (click)="toggleBookmark(movie)"
            >
              <i class="fa-solid fa-bookmark" *ngIf="movie.isBookmarked"></i>
              <i class="fa-regular fa-bookmark" *ngIf="!movie.isBookmarked"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <h2 class="title is-size-4 mt-6">Add Bookmarked Movies</h2>
  <div class="field is-grouped mb-4 is-align-items-center">
    <div class="control">
      <div class="select is-inline">
        <select [(ngModel)]="selectedYear" (change)="onDateChange()" class="custom-select">
          <option *ngFor="let year of years" [value]="year">{{ year }}</option>
        </select>
      </div>
    </div>

    <div class="control" style="margin-left: 55px">
      <button (click)="previousPage()" class="button">
        <i class="fas fa-arrow-left"></i>
      </button>
    </div>
    <div class="control">{{ result.page }}/{{ result.total_pages }}</div>
    <div class="control">
      <button (click)="nextPage()" class="button">
        <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </div>

  <div class="columns is-multiline">
    <div class="column is-one-third" *ngFor="let movie of films">
      <div class="card movie-card">
        <div class="card-image">
          <figure class="image is-2by3">
            <img
              [src]="'https://image.tmdb.org/t/p/original' + movie.poster_path"
              alt="{{ movie.title }}"
              loading="lazy"
            />
          </figure>
        </div>
        <div class="card-content">
          <p class="title is-5">
            <a href="https://www.themoviedb.org/movie/{{ movie.id }}" target="_blank"
              >{{ movie.title }}</a
            >
          </p>
          <p class="subtitle is-6">{{ movie.release_date }}</p>
          <div class="buttons">
            <button (click)="downloadICSCalendar(movie)" class="button is-small">
              Download Calendar
            </button>
            <button
              class="transparent-button"
              (click)="addToggleBookmark(movie)"
            >
              <i class="fa-solid fa-bookmark" *ngIf="movie.isBookmarked"></i>
              <i class="fa-regular fa-bookmark" *ngIf="!movie.isBookmarked"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
